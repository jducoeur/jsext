package org.querki.jsext.dom

import org.scalajs.dom
import scala.scalajs.js

/**
  * A helper utility that prevents mobile browsers from dimming the display.
  */
object WakeLock {
  private trait WakeLock {
    def request(): Unit
    def release(): Unit
  }

  private class IOSWakeLock extends WakeLock {
    var timer: js.timers.SetIntervalHandle = null
    def request(): Unit = {
      def stop = dom.window.asInstanceOf[js.Dynamic].applyDynamic("stop")()
      // under ios, repeatedly smash the href and then cancel immediately.
      timer = scalajs.js.timers.setInterval(15000) {
        if(timer != null) {
          dom.window.location.href = dom.window.location.href
          scalajs.js.timers.setTimeout(0)(stop)
        }
      }
    }
    def release(): Unit = {
      if(timer != null) {
        scalajs.js.timers.clearInterval(timer)
        timer = null
      }
    }
  }

  private class AndroidWakeLock extends WakeLock {
    // on android- we can simply start a video to keep the display alive.
    val video = dom.document.createElement("video").asInstanceOf[dom.html.Video]

    video.addEventListener("ended", { e: dom.Event =>
      video.play();
    })

    def request(): Unit = {
      video.src = "data:video/webm;base64,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"
      video.play()
    }

    def release(): Unit = {
      video.pause()
      video.src = ""
    }
  }

  private lazy val client = if(
    dom.window.navigator.userAgent.contains("iPhone") ||
      dom.window.navigator.userAgent.contains("iPod") ||
      dom.window.navigator.userAgent.contains("iPad"))
    new IOSWakeLock()
  else
    new AndroidWakeLock()

  /**
   * Request the browser enters wakelock state.
   *
   * Note: this should only be called within an input event handler.
   */
  def request(): Unit =
    client.request()

  /**
   * Release the wakelock state.
   */
  def release(): Unit =
    client.release()
}
